const translations = {
    ar: {
        nav_home: "الرئيسية",
        nav_problem: "المشكلة",
        nav_features: "المميزات",
        nav_faq: "الأسئلة الشائعة",
        nav_cta: "ابدأ أسبوعك المجاني",
        hero_title: `استعد لزمالة الطب النفسي<br>وأنت على رأس العمل..<br><span class="highlight">بدون أن تحترق.</span>`,
        hero_subtitle: `خلّينا نكون واقعيين.. مفيش وقت.. مفيش طاقة..<br>والـ textbooks أكبر من اليوم نفسه.<br><strong>ومع ذلك… الامتحان جاي.</strong>`,
        hero_button: "ابدأ أسبوعك المجاني الآن",
        hero_note: "بدون بطاقة ائتمان",
        pain_title: "غالبًا بتعيش السيناريو ده يوميًا",
        pain_1: "تصحى على شيفت",
        pain_2: "ترجع مرهق",
        pain_3: "تفتح PDF وتقفله بعد 10 دقايق",
        pain_4: "وتحس بالذنب إنك “مقصّر”",
        guilt_title: "المشكلة مش فيك",
        guilt_text: "معظم طرق التحضير معمولة لناس متفرغة.. لكن إنت طبيب شغال، مسؤول، ووقتك مسروق.<br>طبيعي تحس إنك تايه لو بتذاكر بنفس الأدوات الغلط.",
        shift_title: "طب لو المذاكرة اتبنت على حياتك… مش العكس؟",
        compare_old_tag: "الطريقة القديمة",
        compare_new_tag: "مع بردي",
        shift_bad: "تحتاج 4 ساعات متواصلة من التركيز (المستحيل توفيرها)",
        shift_good: "شرح يغطي 3-5 صفحات أكاديمية في <strong>10 دقائق</strong>",
        solution_title: "كورس بردي – زمالة الطب النفسي",
        solution_desc: "تطبيق واحد يجمع كل ما تحتاجه.",
        sol_feat_1: "<strong>واجهة منظمة:</strong> كل الكورسات في مكان واحد.",
        sol_feat_2: "<strong>وصول فوري:</strong> حمل وابدأ المذاكرة فوراً.",
        sol_feat_3: "<strong>مصمم للأطباء:</strong> ممارسين، نواب، ووافدين.",
        features_title: "أدوات صُممت خصيصًا للطبيب المشغول",
        feat_1_title: "بنك أسئلة متخصص (QBank)",
        feat_1_desc: "مش مجرد أسئلة عشوائية. تدرب على Egyptian Medical License Exam بنفس نظام الامتحان الحقيقي.",
        feat_2_title: "تتبع تقدمك (History)",
        feat_2_desc: "لن تضيع في المنتصف. خاصية History تحفظ لك آخر جلسة لتعود بضغطة واحدة.",
        feat_3_title: "محتوى مكثف ومرتب",
        feat_3_desc: "دروس مقسمة لوحدات صغيرة (Modules) تغطي المنهج بدون حشو.",
        authority_text: "بناءً على المرجع المعتمد:",
        final_title: "لو كملت للآخر… غالبًا ده ليك",
        for_you: "الكورس ده ليك لو:",
        chk_1: "عايز مصدر واحد موثوق",
        chk_2: "عايز خطة تمشي عليها",
        chk_3: "عايز تدخل الامتحان وإنت فاهم",
        final_btn: "ابدأ أسبوعك المجاني الآن",
        final_note: "بدون فيزا - بدون مخاطرة",
        trust_text: `<span style="color: var(--primary-yellow);">★</span> يثق بنا أكثر من <strong>2000 طبيب</strong>`,
        faq_title: "الأسئلة الشائعة",
        faq_1_q: "هل التطبيق مجاني؟",
        faq_1_a: "نعم، الأسبوع الأول مجاني بالكامل بدون الحاجة لبطاقة ائتمان. بعد ذلك يمكنك الاشتراك للوصول الكامل.",
        faq_2_q: "هل الأسئلة مطابقة لنظام الامتحان الحقيقي؟",
        faq_2_a: "نعم، بنك الأسئلة مصمم ليحاكي نظام الامتحان الحقيقي (100 سؤال / 150 دقيقة).",
        faq_3_q: "كم عدد الأسئلة المتوفرة؟",
        faq_3_a: "لدينا أكثر من 11,000 سؤال مع شروحات تفصيلية ويتم تحديثها بشكل مستمر.",
        faq_4_q: "هل يمكنني استخدام التطبيق على أكثر من جهاز؟",
        faq_4_a: "نعم، يمكنك تسجيل الدخول من أي جهاز والوصول لحسابك وتقدمك.",
        faq_5_q: "كيف يمكنني التواصل مع الدعم؟",
        faq_5_a: "يمكنك التواصل معنا عبر WhatsApp أو Telegram الموجودين في الصفحة.",
        store_ios: "TestFlight (iOS)",
        store_xiaomi: "Xiaomi Store",
        store_apk: "Direct APK",
        copyright: "&copy; 2025 Bardi. جميع الحقوق محفوظة.",
        label_huawei: "لهواتف هواوي",
        label_xiaomi: "لهواتف شاومي",
        label_ios: "لهواتف آيفون",
        btn_huawei: "حمل من AppGallery",
        btn_xiaomi: "Xiaomi Store",
        btn_ios: "TestFlight",
        dl_card_free: "مجـــــــانا اول اسبوع",
        dl_card_title: "حمل التطبيق وابدا الان",
        popup_title: "إعداد TestFlight",
        popup_step1: "أولاً: قم بتحميل تطبيق TestFlight من متجر أبل",
        popup_step1_btn: "تحميل TestFlight",
        popup_step2: "لديك TestFlight بالفعل أو قمت بتحميله؟",
        popup_step2_btn: "نزل التطبيق من هنا"
    },
    en: {
        nav_home: "Home",
        nav_problem: "Problem",
        nav_features: "Features",
        nav_faq: "FAQ",
        nav_cta: "Start Free Week",
        hero_title: `Prepare for Psychiatry Fellowship<br>While Working Full-time..<br><span class="highlight">Without Burning Out.</span>`,
        hero_subtitle: `Let's be realistic.. No time.. No energy..<br>Textbooks are bigger than the day itself.<br><strong>Yet… The exam is coming.</strong>`,
        hero_button: "Start Your Free Week Now",
        hero_note: "No Credit Card Required",
        pain_title: "You probably live this scenario daily",
        pain_1: "Wake up for a shift",
        pain_2: "Come back exhausted",
        pain_3: "Open PDF, close it after 10 mins",
        pain_4: "Feel guilty that you are 'falling behind'",
        guilt_title: "It's Not Your Fault",
        guilt_text: "Most prep methods are for people who are free, full-time students... But you are a working doctor, responsible, and your time is stolen.<br>It's normal to feel lost using the wrong tools.",
        shift_title: "What if studying was built around your life... not the opposite?",
        compare_old_tag: "Old Way",
        compare_new_tag: "With Bardi",
        shift_bad: "Requiring 4 continuous hours of focus (almost impossible)",
        shift_good: "Explanation covering 3-5 academic pages in <strong>10 minutes</strong>",
        solution_title: "Bardi Course – Psychiatry Fellowship",
        solution_desc: "One app gathering everything you need.",
        sol_feat_1: "<strong>Organized Interface:</strong> All courses in one place.",
        sol_feat_2: "<strong>Instant Access:</strong> Download and start studying immediately.",
        sol_feat_3: "<strong>Designed for Doctors:</strong> Practitioners, Residents, and Expats.",
        features_title: "Tools Designed Specifically for the Busy Doctor",
        feat_1_title: "Specialized QBank",
        feat_1_desc: "Not just random questions. Practice for the Egyptian Medical License Exam with the real exam system.",
        feat_2_title: "Track Your Progress (History)",
        feat_2_desc: "Don't get lost. History feature saves your last session to resume with one click.",
        feat_3_title: "Condensed & Organized Content",
        feat_3_desc: "Lessons divided into small modules covering the curriculum without fluff.",
        authority_text: "Based on the Reference:",
        final_title: "If you read this far... This is likely for you",
        for_you: "This course is for you if:",
        chk_1: "You want one trusted source",
        chk_2: "You want a plan to follow",
        chk_3: "You want to enter the exam understanding",
        final_btn: "Start Your Free Week Now",
        final_note: "No Visa - No Risk",
        trust_text: `<span style="color: var(--primary-yellow);">★</span> Trusted by over <strong>2000 doctors</strong>`,
        faq_title: "Frequently Asked Questions",
        faq_1_q: "Is the app free?",
        faq_1_a: "Yes, the first week is completely free with no credit card required. After that, you can subscribe for full access.",
        faq_2_q: "Do the questions match the real exam system?",
        faq_2_a: "Yes, the QBank is designed to simulate the real exam environment (100 questions / 150 minutes).",
        faq_3_q: "How many questions are available?",
        faq_3_a: "We have over 11,000 questions with detailed explanations, updated continuously.",
        faq_4_q: "Can I use the app on multiple devices?",
        faq_4_a: "Yes, you can log in from any device and access your account and progress.",
        faq_5_q: "How can I contact support?",
        faq_5_a: "You can reach us via WhatsApp or Telegram links on the page.",
        store_ios: "TestFlight (iOS)",
        store_xiaomi: "Xiaomi Store",
        store_apk: "Direct APK",
        copyright: "&copy; 2025 Bardi. All rights reserved.",
        label_huawei: "For Huawei",
        label_xiaomi: "For Xiaomi",
        label_ios: "For iPhone",
        btn_huawei: "Get on AppGallery",
        btn_xiaomi: "Xiaomi Store",
        btn_ios: "TestFlight",
        dl_card_free: "FREE FIRST WEEK",
        dl_card_title: "Download the App & Start Now",
        popup_title: "TestFlight Setup",
        popup_step1: "Step 1: Download TestFlight from App Store",
        popup_step1_btn: "Download TestFlight",
        popup_step2: "Already have TestFlight?",
        popup_step2_btn: "Tap here to Install App"
    }
};

const langToggleBtn = document.getElementById('lang-toggle');
const htmlEl = document.documentElement;

langToggleBtn.addEventListener('click', () => {
    const currentLang = htmlEl.getAttribute('lang');
    const newLang = currentLang === 'ar' ? 'en' : 'ar';
    const newDir = newLang === 'ar' ? 'rtl' : 'ltr';

    htmlEl.setAttribute('lang', newLang);
    htmlEl.setAttribute('dir', newDir);
    langToggleBtn.textContent = newLang === 'ar' ? 'English' : 'العربية';

    updateContent(newLang);
});

// Mobile Menu Toggle
const menuToggle = document.getElementById('mobile-menu');
const navMenuWrapper = document.querySelector('.nav-menu-wrapper');

menuToggle.addEventListener('click', () => {
    menuToggle.classList.toggle('active');
    navMenuWrapper.classList.toggle('active');
});

// Close menu when clicking a link
document.querySelectorAll('.nav-menu a').forEach(link => {
    link.addEventListener('click', () => {
        menuToggle.classList.remove('active');
        navMenuWrapper.classList.remove('active');
    });
});

function updateContent(lang) {
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            el.innerHTML = translations[lang][key];
        }
    });
}

// Navbar Scroll Effect
window.addEventListener('scroll', () => {
    const navbar = document.querySelector('.navbar');
    if (window.scrollY > 50) {
        navbar.style.background = 'rgba(17, 17, 24, 0.98)';
        navbar.style.boxShadow = '0 10px 30px rgba(0,0,0,0.2)';
    } else {
        navbar.style.background = 'rgba(17, 17, 24, 0.9)';
        navbar.style.boxShadow = 'none';
    }
});

// Animations on Scroll
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('fade-in-up');
            entry.target.style.opacity = 1; // Ensure visibility
            observer.unobserve(entry.target);
        }
    });
}, observerOptions);

document.querySelectorAll('.card, .feature-card, .shift-item, .phone-mockup, .hero-content').forEach(el => {
    el.classList.add('fade-in-up'); // Determine initial state via CSS
    el.style.opacity = 0; // Force hidden initially via JS to avoid FOUC
    observer.observe(el);
});

// Inject screen overlay for sheen effect if missing
document.querySelectorAll('.phone-mockup, .f-image').forEach(mockup => {
    // Only add overlay if it doesn't already exist
    if (!mockup.querySelector('.screen-overlay')) {
        const overlay = document.createElement('div');
        overlay.className = 'screen-overlay';
        mockup.appendChild(overlay);
    }
});

// TestFlight Popup Logic
const popup = document.getElementById('ios-popup');
const iosBtns = document.querySelectorAll('.btn-ios');
const closeBtn = document.querySelector('.popup-close');

iosBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
        e.preventDefault();
        popup.classList.add('active');
    });
});

closeBtn.addEventListener('click', () => {
    popup.classList.remove('active');
});

// Close when clicking outside content
popup.addEventListener('click', (e) => {
    if (e.target === popup) {
        popup.classList.remove('active');
    }
});
